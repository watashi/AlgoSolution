<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>There are several cities in a country, and some pairs of those cities are connected by one-way roads (although it is possible that there are one-way roads both from A to B and from B to A). It is possible to get from any city to any other city using roads. A traveler starts from some city, and travels along one of the roads every day. A number <i>x</i> is called <i>vacation-friendly</i> if a traveler can have an <i>x</i>-day long vacation.  That means he can start from some city, travel exactly <i>x</i> roads, and be back at the city where he started.
</p>
<p>A <i>vacation string</i> is an infinite string of '0' and '1' digits, which has a '1' in the <i>x</i>-th (1-based) position if and only if <i>x</i> is a vacation-friendly number.</p>
<p>For example, consider the country shown in the following picture.<br></br>
<img src="http://www.topcoder.com/contest/problem/AllCycleLengths/samplecountry.gif"></img><br></br>
Its vacation string is "0011011111111...": 0->1->3->0 is a 3-day vacation, 0->1->2->3->0 is a 4-day vacation, 0->1->3->0->1->3->0 is a 6-day vacation, 0->1->2->3->0->1->3->0 is a 7-day vacation, and so on.</p>
<p>It turns out that every vacation string becomes periodic at some point. We will enclose the period in parentheses to obtain a finite representation for a vacation string. For example, the above vacation string can be represented by "00110(1)" or "00110111(11)". We will call the shortest possible representation <i>canonical</i>.</p>
<p>Given a description of a country as a vector &lt;string&gt; <b>arcs</b>, where the <i>j</i>-th character of the <i>i</i>-th element of <b>arcs</b> is 'Y' if there is a road from city <i>i</i> to city <i>j</i>, and 'N' otherwise, return the canonical representation of its vacation string.</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>AllCycleLengths</td></tr><tr><td>Method:</td><td>findAll</td></tr><tr><td>Parameters:</td><td>vector &lt;string&gt;</td></tr><tr><td>Returns:</td><td>string</td></tr><tr><td>Method signature:</td><td>string findAll(vector &lt;string&gt; arcs)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td>&#160;&#160;&#160;&#160;</td></tr><tr><td></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>arcs</b> will contain between 2 and 30 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>arcs</b> will contain exactly <i>n</i> characters, where <i>n</i> is the number of elements in <b>arcs</b>.</td></tr><tr><td align="center" valign="top">-</td><td>Each character of each element of <b>arcs</b> will be either 'Y' or 'N'.</td></tr><tr><td align="center" valign="top">-</td><td>The <i>i</i>-th character of the <i>i</i>-th element of <b>arcs</b> will always be 'N'.</td></tr><tr><td align="center" valign="top">-</td><td><b>arcs</b> will define a network of roads where it is possible to get from any city to any other city using the roads.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;NYNN&quot;, &quot;NNYY&quot;, &quot;NNNY&quot;, &quot;YNNN&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;00110(1)&quot;</pre></td></tr><tr><td><table><tr><td colspan="2">The example from the problem statement.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;NY&quot;, &quot;YN&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;(01)&quot;</pre></td></tr><tr><td><table><tr><td colspan="2">Only even numbers are vacation-friendly here.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;NYYYY&quot;, &quot;NNYYY&quot;, &quot;NNNYY&quot;, &quot;NNNNY&quot;, &quot;YNNNN&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;0(1)&quot;</pre></td></tr><tr><td><table><tr><td colspan="2">Every vacation length except 1 is possible here.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;NYNNN&quot;, &quot;NNYNN&quot;, &quot;NNNYN&quot;, &quot;NNNNY&quot;, &quot;YNNYN&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: &quot;010(1)&quot;</pre></td></tr><tr><td><table><tr><td colspan="2">The vacation can start from any vertex.</td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
